# Ansible-Swift-Playbook

Ansible-Swift-Playbook(ASP) is designed to provide a simple solution for deploying an OpenStack
[Swift](http://docs.openstack.org/developer/swift/) cluster.
It leverages the power of the mighty automation tool [Ansible](https://www.ansible.com).


For simplicity it uses [swauth](https://github.com/openstack/swauth) as the authentication middleware to handle accounts.


## Structure and Specific Files
It is best to follow the Best Practices, so ASP has adopted the
structure recommended by Ansible official [Best Practices](http://docs.ansible.com/ansible/playbooks_best_practices.html),
separting varibales, roles, hosts and etc into different directories.

Other than those documented, there are a few our own you need to know.
ASP has used some scripts to automate the process of generating rings, or rather,
ASP has a generator(`builder_gen.py`) to produce the generator,
which would be named `remakerings.sh`, once generated.
There are two naive parsers, which makes the generator could understand very basic
inventory and variable configuration files, located in `lib/`.
You may have a look at them before using.



## Usage

### Deployment

1. After you have fixed system installation and IP configuration,
fill out inventory files, and change those group variables.

2. Place your ssh public key file under `roles/roasted/files/id_rsa.pub`.
Then roast those raw devices, `ansible-playbook -i *** roast.yml`.
By using `roast.yml` you will use `roasted` role on raw devices, which means
configuring ssh server, minor-adjusting file system generated by our preseed,
and etc.

3. Generate your ring, either use ASP's genertor of genertor or do it yourself.
Then place the rings generated under `roles/swift-ring-holder/files/**` for
further distribution.

4. Deploy it! Simply run `ansible-playbook -i *** site.yml`, and wait a while
have a cup of coffee or tea maybe and you are done.

### Adding New Devices Into the Cluster
Modify the ring files and rerun `site.yml`.

### Destroy the Cluster
Run `destroyer.yml`.
